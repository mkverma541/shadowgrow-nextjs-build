"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2880],{2880:function(e,t,r){r.d(t,{CartProvider:function(){return u},j:function(){return p}});var a=r(57437),s=r(2265),o=r(84881),l=r(55682);let i=(e,t)=>{switch(t.type){case"SET_LOADING":return{...e,isLoading:t.payload};case"SET_ERROR":return{...e,error:t.payload};case"SET_ITEMS":return{...e,items:t.payload};case"UPDATE_CART_STATE":return{...e,items:t.payload.items,totalItems:t.payload.totalItems,totalPrice:t.payload.totalPrice};case"TOGGLE_CART":return{...e,isOpen:!e.isOpen};case"OPEN_CART":return{...e,isOpen:!0};case"CLOSE_CART":return{...e,isOpen:!1};default:return e}},n={items:[],isOpen:!1,totalItems:0,totalPrice:0,isLoading:!1,error:null},c=e=>({id:"".concat(e.item_id,"-").concat(e.item_type),item_id:e.item_id,item_type:e.item_type,item_name:e.item_name,sale_price:e.sale_price,original_price:e.original_price,quantity:e.quantity,min_cart_qty:e.min_cart_qty,max_cart_qty:e.max_cart_qty,title:e.item_name,productType:2===e.item_type?"download-package":"digital"}),d=e=>({item_id:e.item_id,item_type:e.item_type,item_name:e.item_name,sale_price:e.sale_price,original_price:e.original_price,quantity:e.quantity,min_cart_qty:e.min_cart_qty,max_cart_qty:e.max_cart_qty}),y=()=>{try{let{useToast:e}=r(41357);return e()}catch(e){return{toast:{success:()=>{},error:()=>{},info:()=>{},warning:()=>{}}}}},u=e=>{let{children:t}=e,[r,u]=(0,s.useReducer)(i,n),{isAuthenticated:p}=(0,o.a)(),{toast:_}=y();(0,s.useEffect)(()=>{l.v.setAuthenticationStatus(p)},[p]),(0,s.useEffect)(()=>{b()},[p]);let g=(0,s.useCallback)(e=>({totalItems:e.reduce((e,t)=>e+t.quantity,0),totalPrice:e.reduce((e,t)=>e+parseFloat(t.sale_price)*t.quantity,0)}),[]),E=(0,s.useCallback)(e=>{let{totalItems:t,totalPrice:r}=g(e);u({type:"UPDATE_CART_STATE",payload:{items:e,totalItems:t,totalPrice:r}})},[g]),b=(0,s.useCallback)(async()=>{u({type:"SET_LOADING",payload:!0}),u({type:"SET_ERROR",payload:null});try{let e=(await l.v.loadCart()).map(c);E(e)}catch(e){console.error("Error refreshing cart:",e),u({type:"SET_ERROR",payload:"Failed to load cart"})}finally{u({type:"SET_LOADING",payload:!1})}},[E]),C=(0,s.useCallback)(async e=>{u({type:"SET_LOADING",payload:!0}),u({type:"SET_ERROR",payload:null});try{let t;if(r.items.find(t=>t.item_id===e.item_id&&t.item_type===e.item_type))t=r.items.map(t=>t.item_id===e.item_id&&t.item_type===e.item_type?{...t,quantity:t.quantity+1}:t);else{let a={...e,quantity:1};t=[...r.items,a]}let a=t.map(d),s=await l.v.syncCart(a);return"success"===s.status?(E(t),_.success("Added to Cart!","".concat(e.title," has been added to your cart successfully."),3e3)):(u({type:"SET_ERROR",payload:s.message}),_.error("Error",s.message,3e3)),s}catch(t){let e=t instanceof Error?t.message:"Failed to add to cart";return u({type:"SET_ERROR",payload:e}),_.error("Error",e,3e3),{status:"error",message:e}}finally{u({type:"SET_LOADING",payload:!1})}},[r.items,E,_]),x=(0,s.useCallback)(async e=>{u({type:"SET_LOADING",payload:!0}),u({type:"SET_ERROR",payload:null});try{let t=r.items.filter(t=>t.id!==e),a=t.map(d),s=await l.v.syncCart(a);return"success"===s.status?(E(t),_.success("Removed from Cart","Item has been removed from your cart.",3e3)):(u({type:"SET_ERROR",payload:s.message}),_.error("Error",s.message,3e3)),s}catch(t){let e=t instanceof Error?t.message:"Failed to remove from cart";return u({type:"SET_ERROR",payload:e}),_.error("Error",e,3e3),{status:"error",message:e}}finally{u({type:"SET_LOADING",payload:!1})}},[r.items,E,_]),f=(0,s.useCallback)(async(e,t)=>{if(t<=0)return x(e);u({type:"SET_LOADING",payload:!0}),u({type:"SET_ERROR",payload:null});try{let a=r.items.map(r=>r.id===e?{...r,quantity:t}:r),s=a.map(d),o=await l.v.syncCart(s);return"success"===o.status?E(a):(u({type:"SET_ERROR",payload:o.message}),_.error("Error",o.message,3e3)),o}catch(t){let e=t instanceof Error?t.message:"Failed to update quantity";return u({type:"SET_ERROR",payload:e}),_.error("Error",e,3e3),{status:"error",message:e}}finally{u({type:"SET_LOADING",payload:!1})}},[r.items,E,x,_]),R=(0,s.useCallback)(async()=>{u({type:"SET_LOADING",payload:!0}),u({type:"SET_ERROR",payload:null});try{let e=await l.v.clearCart();return"success"===e.status?(E([]),_.success("Cart Cleared","Your cart has been cleared successfully.",3e3)):(u({type:"SET_ERROR",payload:e.message}),_.error("Error",e.message,3e3)),e}catch(t){let e=t instanceof Error?t.message:"Failed to clear cart";return u({type:"SET_ERROR",payload:e}),_.error("Error",e,3e3),{status:"error",message:e}}finally{u({type:"SET_LOADING",payload:!1})}},[E,_]),T=(0,s.useCallback)(async()=>{u({type:"SET_LOADING",payload:!0}),u({type:"SET_ERROR",payload:null});try{let e=await l.v.syncCartOnLogin();if("success"===e.status&&e.cart){let t=e.cart.map(c);E(t),_.success("Cart Synced",e.message,3e3)}else"error"===e.status&&(u({type:"SET_ERROR",payload:e.message}),_.error("Error",e.message,3e3));return e}catch(t){let e=t instanceof Error?t.message:"Failed to sync cart";return u({type:"SET_ERROR",payload:e}),_.error("Error",e,3e3),{status:"error",message:e}}finally{u({type:"SET_LOADING",payload:!1})}},[E,_]),h=(0,s.useCallback)(()=>{u({type:"TOGGLE_CART"})},[]),k=(0,s.useCallback)(()=>{u({type:"OPEN_CART"})},[]),w=(0,s.useCallback)(()=>{u({type:"CLOSE_CART"})},[]);return(0,a.jsx)(m.Provider,{value:{cart:r,addToCart:C,removeFromCart:x,updateQuantity:f,clearCart:R,toggleCart:h,openCart:k,closeCart:w,refreshCart:b,syncCartOnLogin:T},children:t})},m=(0,s.createContext)(void 0),p=()=>{let e=(0,s.useContext)(m);if(void 0===e)throw Error("useCart must be used within a CartProvider");return e}},41357:function(e,t,r){r.r(t),r.d(t,{ToastProvider:function(){return E},useToast:function(){return b}});var a=r(57437),s=r(2265),o=r(41671),l=r(99388),i=r(33245),n=r(76865),c=r(32489),d=r(94341),y=r(48614);let u={initial:{opacity:0,y:-50,scale:.9},animate:{opacity:1,y:0,scale:1,transition:{type:"spring",stiffness:300,damping:30}},exit:{opacity:0,y:-50,scale:.9,transition:{duration:.2}}},m={success:{icon:o.Z,bgColor:"bg-green-50 dark:bg-green-900/20",borderColor:"border-green-200 dark:border-green-700",iconColor:"text-green-600 dark:text-green-400",titleColor:"text-green-900 dark:text-green-100",messageColor:"text-green-700 dark:text-green-300"},error:{icon:l.Z,bgColor:"bg-red-50 dark:bg-red-900/20",borderColor:"border-red-200 dark:border-red-700",iconColor:"text-red-600 dark:text-red-400",titleColor:"text-red-900 dark:text-red-100",messageColor:"text-red-700 dark:text-red-300"},info:{icon:i.Z,bgColor:"bg-blue-50 dark:bg-blue-900/20",borderColor:"border-blue-200 dark:border-blue-700",iconColor:"text-blue-600 dark:text-blue-400",titleColor:"text-blue-900 dark:text-blue-100",messageColor:"text-blue-700 dark:text-blue-300"},warning:{icon:n.Z,bgColor:"bg-yellow-50 dark:bg-yellow-900/20",borderColor:"border-yellow-200 dark:border-yellow-700",iconColor:"text-yellow-600 dark:text-yellow-400",titleColor:"text-yellow-900 dark:text-yellow-100",messageColor:"text-yellow-700 dark:text-yellow-300"}},p=s.forwardRef((e,t)=>{let{id:r,type:o,title:l,message:i,duration:n=4e3,onClose:y}=e,p=m[o],_=p.icon;return s.useEffect(()=>{let e=setTimeout(()=>{y(r)},n);return()=>clearTimeout(e)},[r,n,y]),(0,a.jsxs)(d.E.div,{ref:t,variants:u,initial:"initial",animate:"animate",exit:"exit",className:"\n        relative max-w-sm w-full bg-white dark:bg-gray-800 shadow-lg rounded-lg border-l-4 ".concat(p.borderColor,"\n        ").concat(p.bgColor," p-4 mb-4 transform transition-all duration-300 ease-out\n        hover:shadow-xl hover:scale-105\n      "),children:[(0,a.jsx)("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-gray-200 dark:bg-gray-700 rounded-b-lg overflow-hidden",children:(0,a.jsx)(d.E.div,{className:"h-full ".concat(p.iconColor.replace("text-","bg-").replace("dark:text-","dark:bg-")),initial:{width:"100%"},animate:{width:"0%"},transition:{duration:n/1e3,ease:"linear"}})}),(0,a.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,a.jsx)("div",{className:"flex-shrink-0 ".concat(p.iconColor),children:(0,a.jsx)(_,{className:"w-6 h-6"})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0 max-w-full",children:[(0,a.jsx)("h4",{className:"text-sm font-semibold ".concat(p.titleColor," break-words"),children:l}),i&&(0,a.jsx)("p",{className:"text-sm mt-1 ".concat(p.messageColor," break-words overflow-hidden"),children:i})]}),(0,a.jsx)("button",{onClick:()=>y(r),className:"flex-shrink-0 p-1 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200",children:(0,a.jsx)(c.Z,{className:"w-4 h-4 text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300"})})]})]})});p.displayName="CustomToast";let _=e=>{let{toasts:t,onClose:r}=e;return(0,a.jsx)("div",{className:"fixed top-10 left-1/2 transform -translate-x-1/2 z-[9999] space-y-2",children:(0,a.jsx)(y.M,{mode:"popLayout",children:t.map(e=>(0,a.jsx)(p,{...e,onClose:r},e.id))})})},g=(0,s.createContext)(void 0),E=e=>{let{children:t}=e,[r,o]=(0,s.useState)([]),[l,i]=(0,s.useState)(!1);(0,s.useEffect)(()=>{i(!0)},[]);let n=(0,s.useCallback)(e=>{o(t=>t.filter(t=>t.id!==e))},[]),c=(0,s.useCallback)(e=>{let t=Math.random().toString(36).substr(2,9),r={...e,id:t,onClose:n};o(e=>[...e,r])},[n]),d=(0,s.useMemo)(()=>({success:(e,t,r)=>{l&&c({type:"success",title:e,message:t,duration:r})},error:(e,t,r)=>{l&&c({type:"error",title:e,message:t,duration:r})},info:(e,t,r)=>{l&&c({type:"info",title:e,message:t,duration:r})},warning:(e,t,r)=>{l&&c({type:"warning",title:e,message:t,duration:r})}}),[l,c]);return(0,a.jsxs)(g.Provider,{value:{toast:d},children:[t,l&&(0,a.jsx)(_,{toasts:r,onClose:n})]})},b=()=>{let e=(0,s.useContext)(g);if(void 0===e)throw Error("useToast must be used within a ToastProvider");return e}}}]);