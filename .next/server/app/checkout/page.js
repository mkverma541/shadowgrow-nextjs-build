(()=>{var e={};e.id=285,e.ids=[285],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},92048:e=>{"use strict";e.exports=require("fs")},76162:e=>{"use strict";e.exports=require("stream")},71568:e=>{"use strict";e.exports=require("zlib")},48562:(e,r,a)=>{"use strict";a.r(r),a.d(r,{GlobalError:()=>l.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>d,routeModule:()=>x,tree:()=>i}),a(51324),a(37334),a(11930),a(12523);var t=a(23191),s=a(88716),n=a(37922),l=a.n(n),c=a(95231),o={};for(let e in c)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>c[e]);a.d(r,o);let i=["",{children:["checkout",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,51324)),"/Users/apple/Desktop/Personal Projects/shadowgrow/src/app/checkout/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,37334)),"/Users/apple/Desktop/Personal Projects/shadowgrow/src/app/layout.tsx"],loading:[()=>Promise.resolve().then(a.bind(a,11930)),"/Users/apple/Desktop/Personal Projects/shadowgrow/src/app/loading.tsx"],"not-found":[()=>Promise.resolve().then(a.bind(a,12523)),"/Users/apple/Desktop/Personal Projects/shadowgrow/src/app/not-found.tsx"]}],d=["/Users/apple/Desktop/Personal Projects/shadowgrow/src/app/checkout/page.tsx"],u="/checkout/page",m={require:a,loadChunk:()=>Promise.resolve()},x=new t.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/checkout/page",pathname:"/checkout",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:i}})},49237:(e,r,a)=>{Promise.resolve().then(a.bind(a,15938))},86333:(e,r,a)=>{"use strict";a.d(r,{Z:()=>t});let t=(0,a(62881).Z)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},6343:(e,r,a)=>{"use strict";a.d(r,{Z:()=>t});let t=(0,a(62881).Z)("book-open",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]])},29798:(e,r,a)=>{"use strict";a.d(r,{Z:()=>t});let t=(0,a(62881).Z)("house",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]])},54689:(e,r,a)=>{"use strict";a.d(r,{Z:()=>t});let t=(0,a(62881).Z)("rotate-ccw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]])},34565:(e,r,a)=>{"use strict";a.d(r,{Z:()=>t});let t=(0,a(62881).Z)("shopping-bag",[["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}],["path",{d:"M3.103 6.034h17.794",key:"awc11p"}],["path",{d:"M3.4 5.467a2 2 0 0 0-.4 1.2V20a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6.667a2 2 0 0 0-.4-1.2l-2-2.667A2 2 0 0 0 17 2H7a2 2 0 0 0-1.6.8z",key:"o988cm"}]])},14228:(e,r,a)=>{"use strict";a.d(r,{Z:()=>t});let t=(0,a(62881).Z)("truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]])},15938:(e,r,a)=>{"use strict";a.r(r),a.d(r,{default:()=>ex,dynamic:()=>em});var t=a(10326),s=a(17577),n=a.n(s),l=a(35047),c=a(77506),o=a(69669),i=a(86333),d=a(90434),u=a(39194),m=a(3053),x=a(36283),y=a(48705),h=a(34565),g=a(6343),p=a(16671);let f=(0,a(62881).Z)("box",[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);var b=a(85597),w=a(83456);function j({item:e}){return(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[t.jsx("div",{className:"w-12 h-12 bg-gray-200 dark:bg-gray-700 rounded-lg flex items-center justify-center flex-shrink-0",children:e.thumbnail?t.jsx("img",{src:e.thumbnail,alt:e.title,className:"w-full h-full object-cover rounded-lg"}):t.jsx("div",{className:"flex items-center justify-center w-full h-full",children:function(e){switch(e){case b.Z.DIGITAL_FILE:return t.jsx(x.Z,{className:"w-6 h-6 text-blue-500"});case b.Z.SUBSCRIPTION_PACKAGE:return t.jsx(y.Z,{className:"w-6 h-6 text-purple-500"});case b.Z.DIGITAL_PRODUCT:return t.jsx(h.Z,{className:"w-6 h-6 text-pink-500"});case b.Z.COURSES:return t.jsx(g.Z,{className:"w-6 h-6 text-green-500"});case b.Z.WALLET_RECHARGE:return t.jsx(p.Z,{className:"w-6 h-6 text-yellow-500"});case b.Z.PHYSICAL_PRODUCT:return t.jsx(f,{className:"w-6 h-6 text-orange-500"});default:return t.jsx(x.Z,{className:"w-6 h-6 text-gray-400"})}}(e.item_type)})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[t.jsx("h4",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 truncate",children:e.title}),t.jsx("div",{className:"flex items-center gap-2 text-xs text-gray-500 dark:text-gray-400",children:(0,t.jsxs)("span",{children:["Qty: ",e.quantity]})})]}),t.jsx("div",{className:"text-right",children:t.jsx("div",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100",children:t.jsx(w.default,{amount:parseFloat(e.sale_price)*e.quantity})})})]})}var N=a(14228);function k({cart:e,subtotal:r,shipping:a,total:s,hasPhysicalProducts:n,hasDigitalProducts:l}){return(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6 sticky top-8",children:[t.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-gray-100 mb-6",children:"Order Summary"}),t.jsx("div",{className:"space-y-3 mb-6",children:e.items.map(e=>t.jsx(j,{item:e},e.id))}),(0,t.jsxs)("div",{className:"space-y-3 border-t border-gray-200 dark:border-gray-700 pt-4",children:[(0,t.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,t.jsxs)("span",{className:"text-gray-600 dark:text-gray-400",children:["Subtotal (",e.totalItems," items)"]}),t.jsx("span",{className:"font-medium text-gray-900 dark:text-gray-100",children:t.jsx(w.default,{amount:r})})]}),n&&(0,t.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,t.jsxs)("span",{className:"text-gray-600 dark:text-gray-400 flex items-center",children:[t.jsx(N.Z,{className:"w-4 h-4 mr-1"}),"Shipping"]}),t.jsx("span",{className:"font-medium text-gray-900 dark:text-gray-100",children:t.jsx(w.default,{amount:a})})]}),t.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-3",children:(0,t.jsxs)("div",{className:"flex justify-between text-lg font-bold text-gray-900 dark:text-gray-100",children:[t.jsx("span",{children:"Total"}),t.jsx("span",{className:"text-blue-600 dark:text-blue-400",children:t.jsx(w.default,{amount:s})})]})})]}),t.jsx("div",{className:"mt-4 p-3 bg-gray-50 dark:bg-gray-800/50 rounded-lg",children:(0,t.jsxs)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[l&&(0,t.jsxs)("div",{className:"flex items-center mb-2",children:[t.jsx("span",{className:"w-2 h-2 bg-blue-500 dark:bg-blue-400 rounded-full mr-2"}),t.jsx("span",{children:"Digital products: Instant download"})]}),n&&(0,t.jsxs)("div",{className:"flex items-center",children:[t.jsx("span",{className:"w-2 h-2 bg-green-500 dark:bg-green-400 rounded-full mr-2"}),t.jsx("span",{children:"Physical products: 3-5 business days shipping"})]})]})}),t.jsx("div",{className:"mt-6 p-4 bg-gray-50 dark:bg-gray-800/50 rounded-lg",children:(0,t.jsxs)("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:["By completing your purchase, you agree to our"," ",t.jsx("a",{href:"/terms",className:"text-blue-600 dark:text-blue-400 hover:underline",children:"Terms of Service"})," ","and"," ",t.jsx("a",{href:"/privacy",className:"text-blue-600 dark:text-blue-400 hover:underline",children:"Privacy Policy"}),"."]})})]})}var P=a(86704);class v{constructor(e){this.currentRazorpayInstance=null,this.paymentPromise=null,this.name="Razorpay",this.publicKey=e}async createOrder(e,r="INR"){try{let a=await P.w5.request("/api/v1/user/payment/razorpay/create-order",{method:"POST",body:{amount:100*e,currency:r},requiresAuth:!0});if("success"===a.status)return a;throw Error("Failed to create Razorpay order")}catch(e){throw console.error("Error creating Razorpay order:",e),e}}async processPayment(e,r="INR",a,t="Customer"){if(this.paymentPromise)return this.paymentPromise;this.paymentPromise=this._processPayment(e,r,a||"",t);try{return await this.paymentPromise}finally{this.paymentPromise=null,this.currentRazorpayInstance=null}}async _processPayment(e,r="INR",a,t="Customer"){try{let s=await this.createOrder(e,r);await this.loadRazorpayScript();let n={key:this.publicKey,amount:s.data.amount,currency:s.data.currency,name:"",description:"",order_id:s.data.id,handler:e=>{this.handlePaymentSuccess(e,s.order_id)},prefill:{name:t,email:a},theme:{color:"#3B82F6"},modal:{ondismiss:()=>{console.log("Payment modal dismissed by user")}}};return this.currentRazorpayInstance=new window.Razorpay(n),this.currentRazorpayInstance.open(),new Promise((e,r)=>{let a=!1,t=r=>{a||(a=!0,e(r))};this.currentRazorpayInstance.on("payment.success",e=>{t({success:!0,status:"success",message:"Payment completed successfully!",data:e})}),this.currentRazorpayInstance.on("payment.failed",e=>{let r=this.getErrorMessage(e.error);t({success:!1,status:"failed",message:r,data:e})}),this.currentRazorpayInstance.on("modal.dismiss",()=>{t({success:!1,status:"cancelled",message:"Payment was cancelled by you.",data:null})}),this.currentRazorpayInstance.on("external.window.close",()=>{t({success:!1,status:"cancelled",message:"Payment window was closed.",data:null})}),this.currentRazorpayInstance.on("error",e=>{t({success:!1,status:"error",message:"An unexpected error occurred during payment.",data:e})}),setTimeout(()=>{t({success:!1,status:"error",message:"Payment timeout. Please try again.",data:null})},3e5)})}catch(e){return console.error("Error processing Razorpay payment:",e),{success:!1,status:"error",message:"Failed to initialize payment. Please try again.",data:e}}}cancelPayment(){if(this.currentRazorpayInstance){try{this.currentRazorpayInstance.close()}catch(e){console.error("Error closing Razorpay instance:",e)}this.currentRazorpayInstance=null}this.paymentPromise=null}async loadRazorpayScript(){return new Promise((e,r)=>{if(window.Razorpay){e();return}let a=document.createElement("script");a.src="https://checkout.razorpay.com/v1/checkout.js",a.onload=()=>e(),a.onerror=()=>r(Error("Failed to load Razorpay script")),document.head.appendChild(a)})}async handlePaymentSuccess(e,r){try{let a=await P.w5.request("/api/v1/user/payment/razorpay/update/order",{method:"POST",body:{razorpay_payment_id:e.razorpay_payment_id,razorpay_order_id:e.razorpay_order_id,razorpay_signature:e.razorpay_signature,order_id:r},requiresAuth:!0});if("success"!==a.status)throw Error("Failed to update order after payment");window.location.href=`/checkout/success?order_id=${r}`}catch(e){console.error("Error handling payment success:",e)}}getErrorMessage(e){if(!e)return"Payment failed. Please try again.";switch(e.code){case"PAYMENT_CANCELLED":return"Payment was cancelled by you.";case"PAYMENT_DECLINED":return"Payment was declined by your bank. Please try a different payment method.";case"INSUFFICIENT_FUNDS":return"Insufficient funds in your account. Please try a different payment method.";case"CARD_DECLINED":return"Your card was declined. Please try a different card or payment method.";case"NETWORK_ERROR":return"Network error occurred. Please check your internet connection and try again.";case"TIMEOUT":return"Payment request timed out. Please try again.";case"INVALID_CARD":return"Invalid card details. Please check and try again.";case"EXPIRED_CARD":return"Your card has expired. Please use a different card.";case"CVV_FAILED":return"Invalid CVV. Please check and try again.";case"OTP_FAILED":return"Invalid OTP. Please try again.";case"AUTHENTICATION_FAILED":return"Payment authentication failed. Please try again.";default:return e.description||"Payment failed. Please try again."}}}let C=e=>new v(e);var _=a(28812);class E{constructor(e){this.currentCashfreeInstance=null,this.paymentPromise=null,this.name="Cashfree",this.appId=e}async createOrder(e,r="INR"){try{let a=await P.w5.request(_.Hv.PAYMENT.CASHFREE_ORDER,{method:"POST",body:{amount:e,currency:r},requiresAuth:!0});if("success"===a.status)return a;{let e=a.message||"Failed to create Cashfree order";throw Error(e)}}catch(e){if(console.error("Error creating Cashfree order:",e),e.response?.data){let r=e.response.data;throw Error(r.message||r.error||"Failed to create Cashfree order")}throw Error(e.message||"Failed to create Cashfree order")}}async processPayment(e,r="INR",a,t="Customer"){if(this.paymentPromise)return this.paymentPromise;this.paymentPromise=this._processPayment(e,r,a||"",t);try{return await this.paymentPromise}finally{this.paymentPromise=null,this.currentCashfreeInstance=null}}async _processPayment(e,r="INR",a,t="Customer"){try{let s=await this.createOrder(e,r);try{await this.loadCashfreeScript()}catch(e){if(console.error("Failed to load Cashfree Test SDK:",e),s.data?.cf_order_id){let e=`https://cashfree.com/pg/view/${s.data.cf_order_id}`,r=window.open(e,"cashfree_payment","width=800,height=600,scrollbars=yes,resizable=yes");if(r)return new Promise(e=>{let a=setInterval(()=>{r.closed&&(clearInterval(a),e({success:!1,status:"cancelled",message:"Payment window was closed.",data:null}))},1e3)});throw Error("Popup blocked. Please allow popups and try again.")}throw Error("Unable to process Cashfree payment. Please try again.")}if(!window.Cashfree)throw console.error("Cashfree SDK not available after loading"),Error("Cashfree payment system not available. Please try again.");let n={appId:this.appId,orderToken:s.data?.payment_session_id||"",orderAmount:s.data?.order_amount||0,orderCurrency:s.data?.order_currency||"INR",orderNote:`Payment for order ${s.data?.order_id||""}`,customerName:t,customerEmail:a,customerPhone:"",hideOrderId:!1,source:"web"};try{this.currentCashfreeInstance=new window.Cashfree(n),this.currentCashfreeInstance.drop(n)}catch(e){throw console.error("Error creating Cashfree instance:",e),Error("Failed to initialize Cashfree payment. Please try again.")}return new Promise((e,r)=>{let a=!1,t=r=>{a||(a=!0,e(r))};if(!this.currentCashfreeInstance||"function"!=typeof this.currentCashfreeInstance.on){if(console.warn("Cashfree instance does not have expected methods, using fallback"),s.data?.cf_order_id){let e=`https://cashfree.com/pg/view/${s.data.cf_order_id}`,r=window.open(e,"cashfree_payment","width=800,height=600,scrollbars=yes,resizable=yes");if(r){let e=setInterval(()=>{r.closed&&(clearInterval(e),t({success:!1,status:"cancelled",message:"Payment window was closed.",data:null}))},1e3)}else t({success:!1,status:"error",message:"Popup blocked. Please allow popups and try again.",data:null})}else t({success:!1,status:"error",message:"Unable to process Cashfree payment. Please try again.",data:null});return}this.currentCashfreeInstance.on("payment.success",e=>{t({success:!0,status:"success",message:"Payment completed successfully!",data:e})}),this.currentCashfreeInstance.on("payment.failed",e=>{console.error("Cashfree payment failed:",e);let r=this.getErrorMessage(e.error);t({success:!1,status:"failed",message:r,data:e})}),this.currentCashfreeInstance.on("modal.dismiss",()=>{t({success:!1,status:"cancelled",message:"Payment was cancelled by you.",data:null})}),this.currentCashfreeInstance.on("external.window.close",()=>{t({success:!1,status:"cancelled",message:"Payment window was closed.",data:null})}),this.currentCashfreeInstance.on("error",e=>{console.error("Cashfree payment error:",e);let r=this.getErrorMessage(e);t({success:!1,status:"error",message:r,data:e})}),setTimeout(()=>{a||(console.warn("Cashfree payment timeout - no events received"),t({success:!1,status:"error",message:"Payment request timed out. Please try again.",data:null}))},3e5)})}catch(r){console.error("Cashfree payment processing error:",r);let e="Failed to initialize Cashfree payment. Please try again.";return r instanceof Error?e=r.message:"string"==typeof r&&(e=r),{success:!1,status:"error",message:e,data:r}}}async loadCashfreeScript(){if(!window.Cashfree)return new Promise((e,r)=>{let a=document.createElement("script");a.src="https://sdk.cashfree.com/js/ui/2.0.0/cashfree.prod.js",a.async=!0,a.onload=()=>{console.log("Cashfree SDK loaded successfully"),e()},a.onerror=e=>{console.error("Failed to load Cashfree SDK:",e),r(Error("Failed to load Cashfree SDK"))},document.head.appendChild(a),setTimeout(()=>{window.Cashfree||r(Error("Cashfree SDK loading timeout"))},1e4)})}async handlePaymentSuccess(e,r){try{await P.w5.request(_.Hv.PAYMENT.CASHFREE_ORDER_STATUS,{method:"POST",body:{order_id:r,payment_status:"success",payment_data:e},requiresAuth:!0})}catch(e){console.error("Failed to update order status:",e)}}getErrorMessage(e){if(!e)return"Payment failed. Please try again.";switch(e.code){case"PAYMENT_CANCELLED":return"Payment was cancelled by you.";case"PAYMENT_DECLINED":return"Payment was declined by your bank. Please try a different payment method.";case"INSUFFICIENT_FUNDS":return"Insufficient funds in your account. Please try a different payment method.";case"CARD_DECLINED":return"Your card was declined. Please try a different card or payment method.";case"NETWORK_ERROR":return"Network error occurred. Please check your internet connection and try again.";case"TIMEOUT":return"Payment request timed out. Please try again.";case"INVALID_CARD":return"Invalid card details. Please check and try again.";case"EXPIRED_CARD":return"Your card has expired. Please use a different card.";case"CVV_FAILED":return"Invalid CVV. Please check and try again.";case"OTP_FAILED":return"Invalid OTP. Please try again.";case"AUTHENTICATION_FAILED":return"Payment authentication failed. Please try again.";case"ORDER_NOT_FOUND":return"Order not found. Please try again.";case"INVALID_ORDER_TOKEN":return"Invalid order token. Please try again.";case"PAYMENT_ALREADY_PROCESSED":return"Payment has already been processed for this order.";default:return e.description||"Payment failed. Please try again."}}}let I=e=>new E(e),S=null,A=0;async function R(){let e=Date.now();if(S&&e-A<3e5)return S;try{let r=await P.w5.request(_.Hv.MISC.CURRENCIES,{method:"GET",requiresAuth:!1});if("success"===r.status&&r.data){let a={};return r.data.forEach(e=>{a[e.currency_code]=parseFloat(e.rate)}),S=a,A=e,a}}catch(e){console.error("Failed to fetch exchange rates:",e)}return{USD:1,INR:90,EUR:.92,GBP:.79,JPY:149}}async function D(e,r){if("USD"===r)return e;try{let a=(await R())[r];if(a&&a>0)return e/a;return console.warn(`Exchange rate not found for ${r}, using fallback`),e}catch(r){return console.error("Error fetching exchange rates:",r),e}}async function T(e,r,a){let t=await D(e,r),s=a>=t,n=t-a;return{sufficient:s,amountInUSD:t,shortfall:n,message:s?`Sufficient balance. Remaining: $${(a-t).toFixed(2)} USD`:`Insufficient balance. Shortfall: $${n.toFixed(2)} USD`}}let F={name:"Wallet",checkBalance:async(e,r,a)=>await T(e,r,a),async processPayment(e,r="INR",a,t,s){let n=await D(e,r);if(void 0===s||s<n){let e=n-(s||0);return{success:!1,status:"failed",message:`Insufficient wallet balance. You need $${n.toFixed(2)} USD but have $${s?.toFixed(2)||"0.00"} USD. Shortfall: $${e.toFixed(2)} USD.`}}try{let a=await P.w5.request(_.Hv.PAYMENT.ACCOUNT_BALANCE,{method:"POST",body:{amount:e,currency:r,amount_usd:n},requiresAuth:!0});if(a.order_id)return{success:!0,status:"success",message:`Payment successful using wallet! Amount: ${r} ${e.toFixed(2)} (USD $${n.toFixed(2)})`,data:a};return{success:!1,status:"failed",message:"Failed to create wallet order."}}catch(e){return{success:!1,status:"error",message:"Wallet payment failed. Please try again.",data:e}}}};var O=a(46581);let Z={name:"PayPal",processPayment:async(e,r="USD",a,t,s)=>{try{let a=await O.K.createOrder({amount:e.toFixed(2),currency:r,return_url:`${window.location.origin}/payment/paypal/success`,cancel_url:`${window.location.origin}/payment/paypal/cancel`,notes:`Payment for ${t||"Customer"}`});if("success"===a.status&&a.data?.checkout_url)return sessionStorage.setItem("paypal_order_id",a.data.order_id.toString()),setTimeout(()=>{window.location.href=a.data.checkout_url},500),{success:!0,status:"processing",message:"Redirecting to PayPal checkout...",data:{order_id:a.data.order_id,checkout_url:a.data.checkout_url,amount:a.data.amount,currency:a.data.currency}};return{success:!1,status:"error",message:"Failed to create PayPal order. Please try again."}}catch(e){return console.error("PayPal payment error:",e),{success:!1,status:"error",message:"An error occurred while processing PayPal payment. Please try again."}}}},U=e=>({name:e,processPayment:async()=>(await new Promise(e=>setTimeout(e,2e3)),Math.random()>.2)?{success:!0,status:"success",message:`${e} payment completed successfully!`}:{success:!1,status:"failed",message:`${e} payment failed. Please try again.`}}),z=(e,r)=>{switch(e){case"razorpay":if(!r)return console.error("Razorpay public key is required"),null;return C(r);case"cashfree":if(!r)return console.error("Cashfree app ID is required"),null;return I(r);case"wallet":return F;case"paypal":return Z;case"offline":return U("Manual Payment");default:return console.error(`Unsupported payment method: ${e}`),null}};var L=a(58038),M=a(88307),q=a(50949);function $(){let[e,r]=(0,s.useState)(null),[a,t]=(0,s.useState)(!0);return{balance:e,loading:a}}var Y=a(26786);let H=({selectedMethod:e,onMethodSelect:r,isLoading:a=!1,onPaymentOptionChange:n,showSearch:l=!0,maxVisible:o=12,cartTotal:i=0})=>{let[d,u]=(0,s.useState)([]),[m,x]=(0,s.useState)(!0),[y,h]=(0,s.useState)(null),[g,p]=(0,s.useState)(""),[f,b]=(0,s.useState)(!1),{balance:w,loading:j}=$(),{currentCurrency:N,convertPrice:k,getCurrencySymbol:v,getCurrentCurrencyData:C}=(0,Y.U)(),_=(0,s.useMemo)(()=>null===w?null:k(w,"USD"),[w,k]),E=(0,s.useMemo)(()=>k(i,"USD"),[i,k]),I=(0,s.useMemo)(()=>null!==_&&0!==E&&_<E,[_,E]),S=C(),A=S?.rate?parseFloat(S.rate):1;(0,s.useEffect)(()=>{(async()=>{try{x(!0),h(null);let a=await P.w5.request("/api/v1/user/payment/options",{method:"GET",requiresAuth:!0});if("success"===a.status&&a.data){let t=a.data.filter(e=>1===e.status);if(u(t),!e&&t.length>0){let e=t.find(e=>1===e.is_default)||t[0];r(e.gateway_type),n?.(e)}}else h("Failed to load payment options")}catch(e){console.error("Error fetching payment options:",e),h("Failed to load payment options")}finally{x(!1)}})()},[e,r,n]);let{filteredOptions:R,hasMore:D}=(0,s.useMemo)(()=>{let e=d.filter(e=>e.name.toLowerCase().includes(g.toLowerCase())||e.description.toLowerCase().includes(g.toLowerCase())||e.gateway_type.toLowerCase().includes(g.toLowerCase()));return{filteredOptions:f?e:e.slice(0,o),hasMore:e.length>o&&!f}},[d,g,f,o]);if(m||j)return(0,t.jsxs)("div",{className:"flex items-center justify-center p-8",children:[t.jsx(c.Z,{className:"w-6 h-6 animate-spin text-blue-600"}),t.jsx("span",{className:"ml-2 text-gray-600 dark:text-gray-400",children:"Loading payment methods..."})]});if(y)return t.jsx("div",{className:"p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:t.jsx("p",{className:"text-red-600 dark:text-red-400 text-sm",children:y})});if(0===d.length)return t.jsx("div",{className:"p-4 bg-gray-50 dark:bg-gray-800/50 border border-gray-200 dark:border-gray-700 rounded-lg",children:t.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm",children:"No payment methods available"})});d.find(e=>"wallet"===e.gateway_type);let T=async(e,t)=>{a||"wallet"===e&&I||(r(e),n?.(t))};return(0,t.jsxs)("div",{className:"space-y-4",children:[t.jsx("h2",{className:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-4",children:"Payment Method"}),l&&d.length>8&&(0,t.jsxs)("div",{className:"relative",children:[t.jsx(M.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),t.jsx("input",{type:"text",placeholder:"Search payment methods...",value:g,onChange:e=>p(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 text-sm"})]}),t.jsx("div",{className:"grid grid-cols-1 gap-4",children:R.map(r=>{let s="wallet"===r.gateway_type,n=s&&I;return(0,t.jsxs)("div",{onClick:()=>{a||s&&n||T(r.gateway_type,r)},className:`
                flex flex-row items-center justify-between p-4
                border rounded-lg cursor-pointer transition-all
                duration-200 shadow-sm bg-white dark:bg-gray-800
                ${e===r.gateway_type?"border-blue-600 bg-blue-50 dark:bg-blue-900/20 ring-2 ring-blue-500":"border-gray-200 dark:border-gray-700 hover:border-gray-400 dark:hover:border-gray-600 dark:hover:bg-gray-700"}
                ${a||s&&n?"opacity-50 cursor-not-allowed":""}`,children:[(0,t.jsxs)("div",{className:"flex items-center gap-4 flex-1",children:[t.jsx("img",{src:`/images/${r.icon}`,alt:r.name,className:"w-8 h-8 object-contain"}),(0,t.jsxs)("div",{className:"flex flex-col flex-1 min-w-0",children:[t.jsx("span",{className:"text-base font-medium text-gray-800 dark:text-gray-100 truncate",children:r.name}),s&&null!==_&&(0,t.jsxs)("div",{className:"mt-1",children:[(0,t.jsxs)("span",{className:"text-xs font-semibold text-green-700 dark:text-green-300",children:["Balance: ",v(),_.toFixed(2)]}),"USD"!==N&&(0,t.jsxs)("div",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:[(0,t.jsxs)("span",{children:["USD $",w?.toFixed(2)]}),(0,t.jsxs)("span",{className:"ml-2",children:["Rate: 1 USD = ",v(),A.toFixed(4)]})]})]}),r.description&&t.jsx("span",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400 leading-tight line-clamp-2",children:r.description}),1===r.is_default&&t.jsx("span",{className:"mt-1 text-xs bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200 px-2 py-0.5 rounded-full w-fit",children:"Default"})]})]}),s&&n&&(0,t.jsxs)("div",{className:"flex flex-col items-end ml-4",children:[(0,t.jsxs)("span",{className:"flex items-center gap-1 text-xs text-red-600 dark:text-red-400 font-medium",children:[t.jsx(q.Z,{className:"w-3 h-3"})," Insufficient balance"]}),(0,t.jsxs)("div",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400 text-right",children:[(0,t.jsxs)("span",{children:["Need: ",v(),E.toFixed(2)]}),t.jsx("br",{}),(0,t.jsxs)("span",{children:["Have: ",v(),_?.toFixed(2)]})]})]})]},r.gateway_type)})}),D&&t.jsx("div",{className:"text-center",children:(0,t.jsxs)("button",{onClick:()=>b(!0),className:"text-blue-600 dark:text-blue-400 hover:text-blue-700 dark:hover:text-blue-300 text-sm font-medium",children:["Show ",d.length-o," more payment methods"]})}),f&&d.length>o&&t.jsx("div",{className:"text-center",children:t.jsx("button",{onClick:()=>b(!1),className:"text-gray-600 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 text-sm font-medium",children:"Show less"})}),l&&g&&(0,t.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-400 text-center",children:[R.length," of ",d.length," payment methods"]})]})};var K=a(30361),B=a(41291),V=a(94019),G=a(29798),W=a(54689),X=a(57671);let J=e=>{switch(e){case"success":return t.jsx(K.Z,{className:"w-16 h-16 text-green-500"});case"failed":case"error":return t.jsx(o.Z,{className:"w-16 h-16 text-red-500"});case"cancelled":return t.jsx(B.Z,{className:"w-16 h-16 text-orange-500"});case"processing":return t.jsx(c.Z,{className:"w-16 h-16 text-blue-500 animate-spin"});default:return t.jsx(B.Z,{className:"w-16 h-16 text-blue-500"})}},Q=e=>{switch(e){case"success":return"Payment Successful!";case"failed":return"Payment Failed";case"cancelled":return"Payment Cancelled";case"error":return"Payment Error";default:return"Processing Payment"}},ee=e=>{switch(e){case"success":return"text-green-600 dark:text-green-400";case"failed":case"error":return"text-red-600 dark:text-red-400";case"cancelled":return"text-orange-600 dark:text-orange-400";default:return"text-blue-600 dark:text-blue-400"}},er=e=>{switch(e){case"success":return"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800";case"failed":case"error":return"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800";case"cancelled":return"bg-orange-50 dark:bg-orange-900/20 border-orange-200 dark:border-orange-800";default:return"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800"}},ea=({isOpen:e,onClose:r,status:a,message:s,gatewayName:n,amount:l,onRetry:o})=>e?t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:e=>{e.target===e.currentTarget&&r()},onKeyDown:e=>{"Escape"===e.key&&r()},tabIndex:-1,children:(0,t.jsxs)("div",{className:`relative max-w-md w-full ${er(a)} border rounded-xl shadow-xl`,children:[t.jsx("button",{onClick:r,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors",children:t.jsx(V.Z,{className:"w-5 h-5"})}),(0,t.jsxs)("div",{className:"p-6 text-center",children:[t.jsx("div",{className:"flex justify-center mb-4",children:J(a)}),t.jsx("h2",{className:`text-xl font-semibold mb-2 ${ee(a)}`,children:Q(a)}),(0,t.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:["via ",n]}),l&&"processing"!==a&&(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-3 mb-4",children:[t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Amount Paid"}),t.jsx("p",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:l.toFixed(2)})]}),t.jsx("p",{className:"text-gray-700 dark:text-gray-300 mb-6 leading-relaxed",children:s}),"processing"===a&&(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-4",children:[(0,t.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:["Please wait while we connect to ",n,"..."]}),(0,t.jsxs)("div",{className:"flex items-center justify-center space-x-2",children:[t.jsx(c.Z,{className:"w-4 h-4 animate-spin text-blue-600"}),t.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Initializing payment gateway"})]})]}),t.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"If the payment window opens, you can close this dialog"}),t.jsx("p",{className:"text-xs text-orange-600 dark:text-orange-400",children:"If the payment window doesn't open, please check your popup blocker settings"}),t.jsx("button",{onClick:r,className:"w-full bg-gray-200 text-gray-800 py-2 px-4 rounded-lg hover:bg-gray-300 transition-colors text-sm",children:"Cancel / Close"})]}),"processing"!==a&&(0,t.jsxs)("div",{className:"space-y-3",children:["success"===a&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(d.default,{href:"/",className:"w-full bg-green-600 text-white py-2 px-4 rounded-lg hover:bg-green-700 transition-colors flex items-center justify-center gap-2",children:[t.jsx(G.Z,{className:"w-4 h-4"}),"Go to Home"]}),t.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"A receipt has been sent to your email"})]}),("failed"===a||"error"===a)&&(0,t.jsxs)(t.Fragment,{children:[o&&(0,t.jsxs)("button",{onClick:o,className:"w-full bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors flex items-center justify-center gap-2",children:[t.jsx(W.Z,{className:"w-4 h-4"}),"Try Again"]}),(0,t.jsxs)(d.default,{href:"/cart",className:"w-full bg-gray-200 text-gray-800 py-2 px-4 rounded-lg hover:bg-gray-300 transition-colors flex items-center justify-center gap-2",children:[t.jsx(X.Z,{className:"w-4 h-4"}),"Back to Cart"]})]}),"cancelled"===a&&(0,t.jsxs)(t.Fragment,{children:[o&&(0,t.jsxs)("button",{onClick:o,className:"w-full bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors flex items-center justify-center gap-2",children:[t.jsx(W.Z,{className:"w-4 h-4"}),"Try Again"]}),(0,t.jsxs)(d.default,{href:"/cart",className:"w-full bg-gray-200 text-gray-800 py-2 px-4 rounded-lg hover:bg-gray-300 transition-colors flex items-center justify-center gap-2",children:[t.jsx(X.Z,{className:"w-4 h-4"}),"Back to Cart"]}),t.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"You can try a different payment method"})]}),t.jsx("button",{onClick:r,className:"w-full text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 transition-colors text-sm",children:"Close"})]})]})]})}):null,et=({isOpen:e,onClose:r,onConfirm:a,amount:s,walletBalance:n,isLoading:l=!1})=>{let{getCurrencySymbol:c,convertPrice:o}=(0,Y.U)();if(!e)return null;let i=o(s,"USD"),d=o(n,"USD"),u=d>=i,m=i-d;return t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:e=>{e.target===e.currentTarget&&r()},onKeyDown:e=>{"Escape"===e.key&&r()},tabIndex:-1,children:(0,t.jsxs)("div",{className:"relative max-w-md w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl shadow-xl",children:[t.jsx("button",{onClick:r,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors",children:t.jsx(V.Z,{className:"w-5 h-5"})}),(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsxs)("div",{className:"text-center mb-6",children:[t.jsx("div",{className:"flex justify-center mb-3",children:t.jsx(p.Z,{className:"w-12 h-12 text-blue-600"})}),t.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-gray-100 mb-2",children:"Confirm Wallet Payment"}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Review your payment details before confirming"})]}),(0,t.jsxs)("div",{className:"space-y-4 mb-6",children:[t.jsx("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4",children:(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Amount to Pay:"}),(0,t.jsxs)("span",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:[c()," ",i.toFixed(2)]})]})}),t.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4",children:(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Current Balance:"}),(0,t.jsxs)("span",{className:"text-lg font-semibold text-blue-600 dark:text-blue-400",children:[c()," ",d.toFixed(2)]})]})}),u?t.jsx("div",{className:"bg-green-50 dark:bg-green-900/20 rounded-lg p-4",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[t.jsx(K.Z,{className:"w-5 h-5 text-green-600"}),(0,t.jsxs)("div",{children:[t.jsx("p",{className:"text-sm font-medium text-green-800 dark:text-green-200",children:"Sufficient Balance"}),(0,t.jsxs)("p",{className:"text-xs text-green-600 dark:text-green-300",children:["Remaining after payment: ",c()," ",(d-i).toFixed(2)]})]})]})}):t.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 rounded-lg p-4",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[t.jsx(B.Z,{className:"w-5 h-5 text-red-600"}),(0,t.jsxs)("div",{children:[t.jsx("p",{className:"text-sm font-medium text-red-800 dark:text-red-200",children:"Insufficient Balance"}),(0,t.jsxs)("p",{className:"text-xs text-red-600 dark:text-red-300",children:["Shortfall: ",c()," ",m.toFixed(2)]})]})]})})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[u?t.jsx("button",{onClick:a,disabled:l,className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700 disabled:bg-blue-400 disabled:cursor-not-allowed transition-colors flex items-center justify-center gap-2",children:l?(0,t.jsxs)(t.Fragment,{children:[t.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Processing..."]}):(0,t.jsxs)(t.Fragment,{children:[t.jsx(K.Z,{className:"w-4 h-4"}),"Confirm Payment"]})}):t.jsx("button",{onClick:r,className:"w-full bg-gray-200 text-gray-800 py-3 px-4 rounded-lg hover:bg-gray-300 transition-colors",children:"Add Funds to Wallet"}),t.jsx("button",{onClick:r,className:"w-full text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 transition-colors text-sm",children:"Cancel"})]}),!u&&t.jsx("div",{className:"mt-4 p-3 bg-orange-50 dark:bg-orange-900/20 rounded-lg",children:(0,t.jsxs)("p",{className:"text-xs text-orange-700 dark:text-orange-300",children:["You need to add ",c(),m.toFixed(2)," more to your wallet to complete this payment."]})})]})]})})};var es=a(18019);let en=e=>{switch(e){case"success":return t.jsx(K.Z,{className:"w-6 h-6 text-green-500"});case"error":return t.jsx(B.Z,{className:"w-6 h-6 text-red-500"});case"warning":return t.jsx(B.Z,{className:"w-6 h-6 text-orange-500"});default:return t.jsx(es.Z,{className:"w-6 h-6 text-blue-500"})}},el=e=>{switch(e){case"success":return{bg:"bg-green-50 dark:bg-green-900/20",border:"border-green-200 dark:border-green-800",text:"text-green-800 dark:text-green-200",title:"text-green-900 dark:text-green-100"};case"error":return{bg:"bg-red-50 dark:bg-red-900/20",border:"border-red-200 dark:border-red-800",text:"text-red-800 dark:text-red-200",title:"text-red-900 dark:text-red-100"};case"warning":return{bg:"bg-orange-50 dark:bg-orange-900/20",border:"border-orange-200 dark:border-orange-800",text:"text-orange-800 dark:text-orange-200",title:"text-orange-900 dark:text-orange-100"};default:return{bg:"bg-blue-50 dark:bg-blue-900/20",border:"border-blue-200 dark:border-blue-800",text:"text-blue-800 dark:text-blue-200",title:"text-blue-900 dark:text-blue-100"}}},ec=({isOpen:e,onClose:r,type:a,title:s,message:l,showCloseButton:c=!0,autoClose:o=!1,autoCloseDelay:i=5e3})=>{if(n().useEffect(()=>{if(e&&o){let e=setTimeout(()=>{r()},i);return()=>clearTimeout(e)}},[e,o,i,r]),!e)return null;let d=el(a);return t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:e=>{e.target===e.currentTarget&&r()},onKeyDown:e=>{"Escape"===e.key&&r()},tabIndex:-1,children:(0,t.jsxs)("div",{className:`relative max-w-md w-full ${d.bg} ${d.border} border rounded-xl shadow-xl transform transition-all animate-in zoom-in-95`,children:[c&&t.jsx("button",{onClick:r,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors",children:t.jsx(V.Z,{className:"w-5 h-5"})}),(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[t.jsx("div",{className:"flex-shrink-0 mt-0.5",children:en(a)}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[t.jsx("h3",{className:`text-lg font-semibold ${d.title} mb-2`,children:s}),t.jsx("p",{className:`text-sm ${d.text} leading-relaxed`,children:l})]})]}),t.jsx("div",{className:"mt-6 flex justify-end",children:t.jsx("button",{onClick:r,className:`px-4 py-2 rounded-lg font-medium transition-colors ${"success"===a?"bg-green-600 text-white hover:bg-green-700":"error"===a?"bg-red-600 text-white hover:bg-red-700":"warning"===a?"bg-orange-600 text-white hover:bg-orange-700":"bg-blue-600 text-white hover:bg-blue-700"}`,children:"OK"})})]})]})})},eo=()=>{let[e,r]=(0,s.useState)({isOpen:!1,type:"info",title:"",message:""}),a=(e,a,t)=>{r({isOpen:!0,type:e,title:a,message:t})};return{alertState:e,showAlert:a,showSuccess:(e,r)=>a("success",e,r),showError:(e,r)=>a("error",e,r),showWarning:(e,r)=>a("warning",e,r),showInfo:(e,r)=>a("info",e,r),closeAlert:()=>{r(e=>({...e,isOpen:!1}))}}},ei={async createOrder(e,r){try{let a=await P.w5.request("/api/v1/user/payment/manual/create-order",{method:"POST",body:{amount:e,currency:r},requiresAuth:!0});if("success"===a.status)return a;throw Error("Failed to create offline order")}catch(e){throw console.error("Error creating offline order:",e),e}}};var ed=a(91664);function eu({cart:e,user:r,isAuthenticated:a,refreshCart:n,clearCart:i}){let u=(0,l.useRouter)(),{alertState:m,showWarning:x,showError:y,closeAlert:h}=eo(),{currentCurrency:g,convertPrice:p}=(0,Y.U)(),{balance:f}=$(),[b,w]=(0,s.useState)(!1),[j,N]=(0,s.useState)("stripe"),[k,P]=(0,s.useState)(null),[v,C]=(0,s.useState)(!1),[_,E]=(0,s.useState)(!1),[I,S]=(0,s.useState)("processing"),[A,R]=(0,s.useState)(""),[T,F]=(0,s.useState)(null),[O,Z]=(0,s.useState)(0),[U,M]=(0,s.useState)(null),q=async r=>{if(r&&r.preventDefault(),b)return;if(!j){x("Payment Method Required","Please select a payment method to continue.");return}if(0===e.items.length){x("Empty Cart","Your cart is empty. Please add items before proceeding to checkout.");return}if("offline"===j){w(!0);try{let r=p(e.totalPrice,"USD"),a=await ei.createOrder(r,g);u.push(`/checkout/offline?order_id=${a?.order_id||"Credit"}&amount=${r}&currency=${g}`)}catch(e){console.error("Failed to create offline order:",e),y("Order Creation Failed","Failed to create offline order. Please try again.")}finally{w(!1)}return}let a=z(j,k?.public_key||void 0);if(!a){y("Invalid Payment Method","The selected payment method is not available. Please choose a different option.");return}if("wallet"===j){Z(await D(e.totalPrice,g)),E(!0);return}await K(a)},K=async a=>{if("paypal"===j){w(!0),F(a),M(null);try{let t=await a.processPayment(e.totalPrice,g,r?.email||"",`${r?.first_name||""} ${r?.last_name||""}`.trim()||"Customer",f||void 0);t.success&&t.data?.checkout_url||(w(!1),F(null),y("PayPal Error",t.message||"Failed to create PayPal order. Please try again."))}catch(e){console.error("PayPal payment error:",e),w(!1),F(null),y("PayPal Error","An error occurred while processing PayPal payment. Please try again.")}return}S("processing"),R("Initializing payment..."),C(!0),w(!0),F(a),M(null);try{let t=await a.processPayment(e.totalPrice,g,r?.email||"",`${r?.first_name||""} ${r?.last_name||""}`.trim()||"Customer",f||void 0);t.success?(S("success"),R("Payment successful! Redirecting..."),M(t.data?.order_id||null),setTimeout(()=>{u.push(`/checkout/success?order_id=${t.data?.order_id||""}`)},2e3)):(S("failed"),R(t.message||"Payment failed. Please try again."))}catch(e){console.error("Payment error:",e),S("error"),R("An error occurred during payment. Please try again.")}finally{w(!1),F(null)}},B=async()=>{E(!1);let e=z("wallet");e&&await K(e)};return e.isLoading?t.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[t.jsx(c.Z,{className:"w-8 h-8 animate-spin mx-auto mb-4 text-blue-600"}),t.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Loading checkout..."})]})}):e.error?t.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center max-w-md mx-auto p-6",children:[t.jsx(o.Z,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),t.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-gray-100 mb-2",children:"Error Loading Cart"}),t.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:e.error}),(0,t.jsxs)("div",{className:"space-y-3",children:[t.jsx("button",{onClick:n,className:"w-full bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors",children:"Try Again"}),t.jsx(d.default,{href:"/cart",className:"block w-full bg-gray-200 text-gray-800 py-2 px-4 rounded-lg hover:bg-gray-300 transition-colors text-center",children:"Back to Cart"})]})]})}):(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:[(0,t.jsxs)("form",{onSubmit:q,className:"p-6 space-y-6",children:[(0,t.jsxs)("div",{children:[t.jsx("h2",{className:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-2",children:"Your Information"}),(0,t.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-800/50 p-4 rounded-lg border border-gray-200 dark:border-gray-700",children:[t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"A receipt and your download links will be sent to the following email address:"}),t.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 mt-2",children:r?.email})]})]}),t.jsx(H,{selectedMethod:j,onMethodSelect:N,onPaymentOptionChange:P,isLoading:b,cartTotal:e.totalPrice}),t.jsx("div",{className:"bg-primary/10 p-4 rounded-lg",children:(0,t.jsxs)("div",{className:"flex items-start gap-2",children:[t.jsx(L.Z,{className:"w-5 h-5 text-primary mt-0.5 flex-shrink-0"}),(0,t.jsxs)("div",{children:[t.jsx("h3",{className:"text-sm font-semibold text-primary mb-1",children:"Secure Payment"}),t.jsx("p",{className:"text-sm text-primary",children:"Your payment will be processed securely by our trusted payment partners. We never store your payment information."})]})]})}),t.jsx(ed.z,{type:"submit",disabled:b,className:"w-full py-3 h-auto mt-4",children:b?(0,t.jsxs)(t.Fragment,{children:[t.jsx(c.Z,{className:"w-4 h-4 mr-2 animate-spin"}),"paypal"===j?"Redirecting to PayPal...":"Processing..."]}):"Pay Now"})]}),t.jsx(ea,{isOpen:v,onClose:()=>{if(b&&T&&"cancelPayment"in T)try{T.cancelPayment()}catch(e){console.error("Error cancelling payment:",e)}C(!1),w(!1),F(null),"success"===I&&u.push("/")},status:I,message:A,gatewayName:k?.name||j,amount:e.totalPrice,onRetry:()=>{C(!1),S("processing"),R(""),setTimeout(()=>{q()},100)}}),t.jsx(et,{isOpen:_,onClose:()=>E(!1),onConfirm:B,amount:e.totalPrice,walletBalance:f||0,isLoading:b}),t.jsx(ec,{isOpen:m.isOpen,onClose:h,type:m.type,title:m.title,message:m.message})]})}let em="force-dynamic";function ex(){(0,l.useRouter)();let{cart:e,refreshCart:r,clearCart:a}=(0,u.j)(),{user:s,isAuthenticated:n}=(0,m.a)();if(e.isLoading)return t.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[t.jsx(c.Z,{className:"w-8 h-8 animate-spin mx-auto mb-4 text-blue-600"}),t.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Loading checkout..."})]})});if(e.error)return t.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center max-w-md mx-auto p-6",children:[t.jsx(o.Z,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),t.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-gray-100 mb-2",children:"Error Loading Cart"}),t.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:e.error}),(0,t.jsxs)("div",{className:"space-y-3",children:[t.jsx("button",{onClick:r,className:"w-full bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors",children:"Try Again"}),t.jsx(d.default,{href:"/cart",className:"block w-full bg-gray-200 text-gray-800 py-2 px-4 rounded-lg hover:bg-gray-300 transition-colors text-center",children:"Back to Cart"})]})]})});let x=e.items.some(e=>"digital"===e.productType||"download-package"===e.productType),y=e.totalPrice;return t.jsx("section",{className:"py-12",children:t.jsx("div",{className:"container mx-auto px-4",children:(0,t.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,t.jsxs)("div",{className:"mb-8",children:[(0,t.jsxs)(d.default,{href:"/cart",className:"inline-flex items-center space-x-2 text-primary hover:text-primary/90 mb-4",children:[t.jsx(i.Z,{className:"w-4 h-4"}),t.jsx("span",{children:"Back to Cart"})]}),t.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-gray-100",children:"Checkout"}),t.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:"Complete your purchase securely"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[t.jsx("div",{className:"lg:col-span-2",children:t.jsx(eu,{cart:e,user:s,isAuthenticated:n,refreshCart:r,clearCart:a})}),t.jsx("div",{className:"lg:col-span-1",children:t.jsx(k,{cart:e,subtotal:y,shipping:0,total:y+0,hasPhysicalProducts:!1,hasDigitalProducts:x})})]})]})})})}},85597:(e,r,a)=>{"use strict";a.d(r,{Z:()=>t});let t={DIGITAL_FILE:1,SUBSCRIPTION_PACKAGE:2,DIGITAL_PRODUCT:3,COURSES:4,WALLET_RECHARGE:5,PHYSICAL_PRODUCT:6,1:"Digital Files",2:"Subscription Package",3:"Digital Product",4:"Courses",5:"Wallet Recharge",6:"Physical Product"}},46581:(e,r,a)=>{"use strict";a.d(r,{K:()=>n});var t=a(86704),s=a(28812);let n={createOrder:async e=>t.w5.request(s.Hv.PAYMENT.PAYPAL_CREATE_ORDER,{method:"POST",requiresAuth:!0,body:e}),verifyPayment:async e=>t.w5.request(s.Hv.PAYMENT.PAYPAL_VERIFY_PAYMENT,{method:"POST",requiresAuth:!0,body:e}),handleWebhook:async e=>t.w5.request(s.Hv.PAYMENT.PAYPAL_WEBHOOK,{method:"POST",requiresAuth:!1,body:e})}},51324:(e,r,a)=>{"use strict";a.r(r),a.d(r,{default:()=>n,dynamic:()=>s});var t=a(68570);let s=(0,t.createProxy)(String.raw`/Users/apple/Desktop/Personal Projects/shadowgrow/src/app/checkout/page.tsx#dynamic`),n=(0,t.createProxy)(String.raw`/Users/apple/Desktop/Personal Projects/shadowgrow/src/app/checkout/page.tsx#default`)}};var r=require("../../webpack-runtime.js");r.C(e);var a=e=>r(r.s=e),t=r.X(0,[9276,2734,2169],()=>a(48562));module.exports=t})();