(()=>{var e={};e.id=7095,e.ids=[7095],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},92048:e=>{"use strict";e.exports=require("fs")},76162:e=>{"use strict";e.exports=require("stream")},71568:e=>{"use strict";e.exports=require("zlib")},80834:(e,r,t)=>{"use strict";t.r(r),t.d(r,{GlobalError:()=>o.a,__next_app__:()=>x,originalPathname:()=>m,pages:()=>c,routeModule:()=>u,tree:()=>d}),t(4442),t(37334),t(11930),t(12523);var s=t(23191),a=t(88716),i=t(37922),o=t.n(i),l=t(95231),n={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(n[e]=()=>l[e]);t.d(r,n);let d=["",{children:["auth",{children:["otp",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,4442)),"/Users/apple/Desktop/Personal Projects/shadowgrow/src/app/auth/otp/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,37334)),"/Users/apple/Desktop/Personal Projects/shadowgrow/src/app/layout.tsx"],loading:[()=>Promise.resolve().then(t.bind(t,11930)),"/Users/apple/Desktop/Personal Projects/shadowgrow/src/app/loading.tsx"],"not-found":[()=>Promise.resolve().then(t.bind(t,12523)),"/Users/apple/Desktop/Personal Projects/shadowgrow/src/app/not-found.tsx"]}],c=["/Users/apple/Desktop/Personal Projects/shadowgrow/src/app/auth/otp/page.tsx"],m="/auth/otp/page",x={require:t,loadChunk:()=>Promise.resolve()},u=new s.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/auth/otp/page",pathname:"/auth/otp",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},75718:(e,r,t)=>{Promise.resolve().then(t.bind(t,57143))},86333:(e,r,t)=>{"use strict";t.d(r,{Z:()=>s});let s=(0,t(62881).Z)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},57143:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>P,dynamic:()=>j});var s=t(10326),a=t(17577),i=t(90434),o=t(35047),l=t(74723),n=t(70987),d=t(42576),c=t(41291),m=t(30361),x=t(86333),u=t(5932);let p=(0,t(62881).Z)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);var g=t(2260),h=t(91664),y=t(25842),f=t(36670),b=t(98904);let j="force-dynamic",v=d.z.object({otp:d.z.string().length(6,"OTP must be exactly 6 digits").regex(/^\d{6}$/,"OTP must contain only numbers")}),k=e=>`w-full pl-12 pr-3 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-gray-100 dark:placeholder-gray-400 text-center text-2xl font-mono tracking-widest ${e?"border-red-300 dark:border-red-600":"border-gray-300 dark:border-gray-600"}`;function P(){let e=(0,o.useRouter)(),r=(0,o.useSearchParams)(),t=r?.get("email"),d=r?.get("redirect")||"/",j=(0,y.I0)(),[P,w]=(0,a.useState)(!1),[N,_]=(0,a.useState)(0),[O,S]=(0,a.useState)(""),[T,q]=(0,a.useState)(""),[E,{isLoading:C}]=(0,g.vp)(),[M,{isLoading:A}]=(0,g.mF)(),{register:D,handleSubmit:F,formState:{errors:z,isValid:R},setValue:U,watch:Z}=(0,l.cI)({resolver:(0,n.F)(v),mode:"onChange"});Z("otp");let L=async r=>{if(t){S("");try{let s=await E({email:t,otp:r.otp}).unwrap();if("success"===s.status&&s.user){let r=s.user,t={id:r.user_id,username:r.username,first_name:r.first_name,last_name:r.last_name,balance:r.balance,avatar:r.avatar,photo:r.photo,email:r.email,token:r.token,hasActivePackage:r.hasActivePackage};j((0,f.av)({user:t,rememberMe:!1})),b.v.syncCartOnLogin().catch(e=>{console.error("Error syncing cart after OTP verification:",e)}),w(!0),setTimeout(()=>{e.push(d)},2e3)}}catch(r){console.error("OTP verification error:",r);let e="OTP verification failed. Please try again.";if(r&&"object"==typeof r){if("data"in r){let t=r.data;t?.status==="error"&&t?.message&&(e=t.message)}else if("error"in r){let t=r.error;t?.status==="error"&&t?.message&&(e=t.message)}else"status"in r&&"message"in r&&r?.status==="error"&&r?.message&&(e=r.message)}else r instanceof Error&&(e=r.message||"OTP verification failed. Please try again.");S(e)}}},G=async()=>{if(t&&!(N>0)){S(""),q("");try{let e=await M({email:t}).unwrap();"success"===e.status?(q(e.message||"OTP sent successfully. Please check your email."),_(20)):S("Failed to resend OTP. Please try again.")}catch(r){console.error("Resend OTP error:",r);let e="Failed to resend OTP. Please try again.";if(r&&"object"==typeof r){if("data"in r){let t=r.data;t?.status==="error"&&t?.message&&(e=t.message)}else if("error"in r){let t=r.error;t?.status==="error"&&t?.message&&(e=t.message)}else"status"in r&&"message"in r&&r?.status==="error"&&r?.message&&(e=r.message)}else r instanceof Error&&(e=r.message||"Failed to resend OTP. Please try again.");S(e)}}};return t?P?s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsx("div",{className:"w-full max-w-md mx-auto",children:(0,s.jsxs)("div",{className:"text-center",children:[s.jsx(m.Z,{className:"w-16 h-16 text-green-500 mx-auto mb-4"}),s.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-gray-100 mb-2",children:"Welcome! Account Verified"}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"Your email has been successfully verified and you're now logged in. Redirecting..."}),s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"})]})})}):s.jsx("div",{className:"flex items-center justify-center py-12",children:(0,s.jsxs)("div",{className:"w-full max-w-md mx-auto",children:[(0,s.jsxs)("div",{className:"text-center mb-8",children:[(0,s.jsxs)(i.default,{href:"/auth/signup",className:"inline-flex items-center text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100 mb-4 transition-colors",children:[s.jsx(x.Z,{className:"w-4 h-4 mr-2"}),"Back to Signup"]}),s.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-gray-100 mb-2",children:"Verify Your Email"}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-2",children:"We've sent a 6-digit verification code to"}),s.jsx("p",{className:"text-blue-600 dark:text-blue-400 font-medium",children:t})]}),(0,s.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-2xl  border border-gray-100 dark:border-gray-700 py-12 px-8",children:[O&&s.jsx("div",{className:"mb-6 p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:s.jsx("p",{className:"text-red-700 dark:text-red-400 text-sm",children:O})}),T&&s.jsx("div",{className:"mb-6 p-4 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg",children:s.jsx("p",{className:"text-green-700 dark:text-green-400 text-sm",children:T})}),(0,s.jsxs)("form",{onSubmit:F(L),className:"space-y-6",children:[(0,s.jsxs)("div",{children:[s.jsx("label",{htmlFor:"otp",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Enter Verification Code"}),(0,s.jsxs)("div",{className:"relative",children:[s.jsx(u.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 dark:text-gray-500 w-5 h-5"}),s.jsx("input",{...D("otp"),type:"text",id:"otp",maxLength:6,placeholder:"000000",className:k(!!z.otp),autoComplete:"one-time-code",autoFocus:!0})]}),z.otp&&s.jsx("p",{className:"text-red-600 dark:text-red-400 text-xs mt-2",children:z.otp.message})]}),s.jsx(h.z,{type:"submit",disabled:C||!R,className:"w-full",children:C?"Verifying...":"Verify Email"}),(0,s.jsxs)("div",{className:"text-center",children:[s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:"Didn't receive the code?"}),s.jsx(h.z,{type:"button",variant:"link",onClick:G,disabled:N>0||A,className:"inline-flex items-center font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:A?(0,s.jsxs)(s.Fragment,{children:[s.jsx(p,{className:"w-4 h-4 mr-2 animate-spin"}),"Sending..."]}):N>0?`Resend in ${N}s`:"Resend Code"})]}),s.jsx("div",{className:"text-center pt-4 border-t border-gray-200 dark:border-gray-700",children:(0,s.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Already verified?"," ",s.jsx(i.default,{href:"/auth/login",className:"text-blue-600 dark:text-blue-400 hover:underline font-medium",children:"Sign in"})]})})]})]})]})}):s.jsx("div",{className:"flex items-center justify-center py-12",children:(0,s.jsxs)("div",{className:"text-center",children:[s.jsx(c.Z,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),s.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-gray-100 mb-2",children:"Email Required"}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"Please complete the signup process first."}),s.jsx(h.z,{asChild:!0,children:s.jsx(i.default,{href:"/auth/signup",children:"Go to Signup"})})]})})}},4442:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>i,dynamic:()=>a});var s=t(68570);let a=(0,s.createProxy)(String.raw`/Users/apple/Desktop/Personal Projects/shadowgrow/src/app/auth/otp/page.tsx#dynamic`),i=(0,s.createProxy)(String.raw`/Users/apple/Desktop/Personal Projects/shadowgrow/src/app/auth/otp/page.tsx#default`)}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[9276,2734,2169],()=>t(80834));module.exports=s})();